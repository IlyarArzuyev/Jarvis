<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
  <title>JARVIS Voice Assistant</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      user-select: none !important;
      -webkit-user-select: none !important;
      -moz-user-select: none !important;
    }

    html, body {
      width: 100%;
      height: 100%;
      background: black;
      font-family: 'Segoe UI', sans-serif;
      overflow: hidden;
      -webkit-user-drag: none;
    }

    body {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .hud-container {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .scanner-line {
      position: absolute;
      width: 2px;
      height: 100px;
      background: #00ffff88;
      animation: scanY 2s linear infinite;
    }

    .scanner-line.left { left: 20px; }
    .scanner-line.right { right: 20px; }

    @keyframes scanY {
      0% { top: 0; opacity: 0; }
      50% { opacity: 1; }
      100% { top: 100%; opacity: 0; }
    }

    .grid {
      position: absolute;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
    }

    .grid svg {
      width: 100%;
      height: 100%;
      opacity: 0.05;
    }

    .voice-button {
      width: 140px;
      height: 140px;
      background: url('https://img2.akspic.ru/crops/1/6/0/7/3/137061/137061-figurka-kostyum_aktera-vymyslennyj_personaz-cifrovoe_iskusstvo-supergeroj-720x1280.jpg137061-figurka-kostyum_aktera-vymyslennyj_personaz-cifrovoe_iskusstvo-supergeroj-720x1280.jpg 720¬†√ó¬†1¬†280 –ø–∏–∫—Å') no-repeat center center;
      background-size: cover;
      border-radius: 50%;
      border: 3px solid #00ffff;
      box-shadow: 0 0 20px #00ffff, inset 0 0 30px #00ffff;
      transition: 0.3s;
      z-index: 10;
      cursor: pointer;
    }

    .voice-button.active {
      box-shadow: 0 0 40px #00ffff, 0 0 80px #00ffff, inset 0 0 60px #00ffff;
      transform: scale(1.1);
    }

    .circles {
      position: absolute;
      width: 300px;
      height: 300px;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1;
    }

    .circle {
      position: absolute;
      border: 2px solid #00ffff33;
      border-radius: 50%;
      animation: rotate 15s linear infinite;
    }

    .circle:nth-child(1) { width: 280px; height: 280px; }
    .circle:nth-child(2) { width: 220px; height: 220px; animation-duration: 20s; }
    .circle:nth-child(3) { width: 160px; height: 160px; animation-duration: 25s; }

    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .status {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      padding: 10px 20px;
      background: rgba(0,255,255,0.05);
      backdrop-filter: blur(8px);
      color: #00ffff;
      border: 1px solid rgba(0,255,255,0.2);
      border-radius: 10px;
      font-size: 16px;
      z-index: 99;
      text-shadow: 0 0 5px #00ffff;
    }
  </style>
</head>
<body>

<div class="hud-container">

  <!-- –°–µ—Ç–∫–∞ -->
  <div class="grid">
    <svg viewBox="0 0 100 100" preserveAspectRatio="none">
      <defs>
        <pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse">
          <path d="M 10 0 L 0 0 0 10" fill="none" stroke="#00ffff" stroke-width="0.3" />
        </pattern>
      </defs>
      <rect width="100%" height="100%" fill="url(#grid)" />
    </svg>
  </div>

  <!-- –°–∫–∞–Ω–µ—Ä—ã -->
  <div class="scanner-line left"></div>
  <div class="scanner-line right"></div>

  <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å -->
  <div class="circles">
    <div class="circle"></div>
    <div class="circle"></div>
    <div class="circle"></div>
    <button id="voiceBtn" class="voice-button" title="–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏"></button>
  </div>
</div>

<div id="status" class="status">üé§ –ú–∏–∫—Ä–æ—Ñ–æ–Ω –≤—ã–∫–ª—é—á–µ–Ω</div>

<script>
  // –ó–∞–ø—Ä–µ—Ç –ø—Ä–∞–≤–æ–≥–æ –∫–ª–∏–∫–∞ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
  document.addEventListener('contextmenu', e => e.preventDefault());
  document.addEventListener('wheel', e => { if (e.ctrlKey) e.preventDefault(); }, { passive: false });

  const voiceBtn = document.getElementById("voiceBtn");
  const statusBox = document.getElementById("status");

  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  const recognition = new SpeechRecognition();
  recognition.lang = "ru-RU";
  recognition.continuous = true;
  recognition.interimResults = false;

  let isListening = false;

  voiceBtn.addEventListener("click", () => {
    if (!isListening) {
      recognition.start();
      voiceBtn.classList.add("active");
      statusBox.textContent = "üéôÔ∏è –°–ª—É—à–∞—é...";
      speak("–ì–æ–ª–æ—Å–æ–≤–æ–π —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω");
      isListening = true;
    } else {
      recognition.stop();
      voiceBtn.classList.remove("active");
      statusBox.textContent = "üé§ –ú–∏–∫—Ä–æ—Ñ–æ–Ω –≤—ã–∫–ª—é—á–µ–Ω";
      speak("–°–ª—É—à–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ");
      isListening = false;
    }
  });

  recognition.onresult = function(event) {
    const transcript = event.results[event.results.length - 1][0].transcript.trim().toLowerCase();
    statusBox.textContent = `‚úÖ –í—ã —Å–∫–∞–∑–∞–ª–∏: "${transcript}"`;
    speak(`–í—ã —Å–∫–∞–∑–∞–ª–∏: ${transcript}`);

    // –ü—Ä–∏–º–µ—Ä: –æ—Ç–∫—Ä—ã—Ç—å –¢–µ–ª–µ–≥—Ä–∞–º
    if (transcript.includes("–æ—Ç–∫—Ä–æ–π —Ç–µ–ª–µ–≥—Ä–∞–º")) {
      speak("–û—Ç–∫—Ä—ã–≤–∞—é –¢–µ–ª–µ–≥—Ä–∞–º");
      window.location.href = "tg://resolve";
    }

    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ n8n
    fetch("https://your-n8n-server.com/webhook/receive-voice", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        text: transcript,
        timestamp: new Date().toISOString()
      })
    });
  };

  recognition.onerror = function(e) {
    statusBox.textContent = "‚ö†Ô∏è –û—à–∏–±–∫–∞: " + e.error;
    speak("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞");
  };

  function speak(text) {
    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = "ru-RU";
    utter.pitch = 0.6;
    utter.rate = 1.05;
    utter.volume = 1;
    speechSynthesis.speak(utter);
  }
</script>

</body>
</html>
